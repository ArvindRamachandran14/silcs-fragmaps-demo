<svg xmlns="http://www.w3.org/2000/svg" width="1900" height="1540" viewBox="0 0 1900 1540" role="img" aria-labelledby="title desc">
  <title id="title">M5.3 advanced rows and exclusion map states</title>
  <desc id="desc">M5.3 Prompt A preview showing default, loading, empty, error, and success states for Advanced rows plus Exclusion map fixed gray wireframe behavior.</desc>
  <defs>
    <style>
      .bg { fill: #f4f5f7; }
      .card { fill: #ffffff; stroke: #cfd8dc; stroke-width: 1.5; }
      .heading { font: 700 22px Arial, sans-serif; fill: #102027; }
      .subhead { font: 700 15px Arial, sans-serif; fill: #263238; }
      .body { font: 13px Arial, sans-serif; fill: #37474f; }
      .muted { font: 12px Arial, sans-serif; fill: #607d8b; }
      .button { fill: #eceff1; stroke: #b0bec5; stroke-width: 1; }
      .button-disabled { fill: #f5f5f5; stroke: #d7d7d7; stroke-width: 1; }
      .checkbox { fill: #ffffff; stroke: #607d8b; stroke-width: 1.2; }
      .checkbox-on { fill: #e8f5e9; stroke: #2e7d32; stroke-width: 1.2; }
      .checkbox-disabled { fill: #f5f5f5; stroke: #b0bec5; stroke-width: 1.2; }
      .divider { stroke: #e0e0e0; stroke-width: 1; }
      .helper { fill: #f8fbff; stroke: #bbdefb; stroke-width: 1; }
      .warn { fill: #fff8e1; stroke: #ffcc80; stroke-width: 1; }
      .error { fill: #ffebee; stroke: #ef9a9a; stroke-width: 1; }
      .good { fill: #e8f5e9; stroke: #a5d6a7; stroke-width: 1; }
      .chip { fill: #eceff1; stroke: #b0bec5; stroke-width: 1; }
      .tab-active { fill: #3f51b5; stroke: #2c3a8c; stroke-width: 1; }
      .tab-inactive { fill: #eceff1; stroke: #c7d0d6; stroke-width: 1; }
      .tab-text-active { font: 700 12px Arial, sans-serif; fill: #ffffff; }
      .tab-text { font: 700 12px Arial, sans-serif; fill: #5f6b73; }
      .tab-text-disabled { font: 700 12px Arial, sans-serif; fill: #90a4ae; }
      .legend { stroke: #455a64; stroke-width: 0.6; }
      .viewer { fill: #f6f8fa; stroke: #c5d0d9; stroke-width: 1; }
      .mesh-blue { fill: none; stroke: #1976d2; stroke-width: 1.2; }
      .mesh-red { fill: none; stroke: #d32f2f; stroke-width: 1.2; }
      .mesh-green { fill: none; stroke: #2e7d32; stroke-width: 1.2; }
      .mesh-orange { fill: none; stroke: #f57c00; stroke-width: 1.2; }
      .mesh-magenta { fill: none; stroke: #c2185b; stroke-width: 1.2; }
      .mesh-gray { fill: none; stroke: #9e9e9e; stroke-width: 1.2; }
      .protein { fill: none; stroke: #273b96; stroke-width: 3; stroke-linecap: round; opacity: 0.95; }
      .disabled-pill { fill: #f4f6f8; stroke: #d1d8de; stroke-width: 1; }
    </style>
  </defs>

  <rect class="bg" x="0" y="0" width="1900" height="1540"/>
  <text class="heading" x="48" y="44">M5.3 Prompt A: Advanced Rows + Exclusion Map (Fixed Gray Wireframe)</text>
  <text class="muted" x="48" y="68">Scope: enable Advanced-row behavior and Exclusion visibility toggle with disabled iso. No per-map iso editing beyond M5.3 scope.</text>

  <!-- Panel A: Default -->
  <g transform="translate(40,100)">
    <rect class="card" x="0" y="0" width="560" height="650" rx="8"/>
    <text class="subhead" x="20" y="34">A. Default</text>
    <text class="muted" x="20" y="54">Advanced section collapsed, Exclusion available but hidden</text>

    <rect class="tab-active" x="20" y="70" width="92" height="26" rx="5"/>
    <text class="tab-text-active" x="43" y="87">FragMap</text>
    <rect class="tab-inactive" x="118" y="70" width="80" height="26" rx="5"/>
    <text class="tab-text" x="143" y="87">Ligand</text>

    <rect class="button" x="20" y="108" width="95" height="30" rx="5"/>
    <text class="body" x="39" y="128">Hide all</text>
    <rect class="button" x="125" y="108" width="120" height="30" rx="5"/>
    <text class="body" x="146" y="128">Reset defaults</text>
    <rect class="button" x="255" y="108" width="95" height="30" rx="5"/>
    <text class="body" x="276" y="128">Reset view</text>

    <line class="divider" x1="20" y1="154" x2="540" y2="154"/>
    <text class="subhead" x="20" y="178">Primary</text>

    <rect class="checkbox" x="20" y="194" width="16" height="16"/>
    <circle class="legend" cx="54" cy="202" r="6" fill="#1976d2"/>
    <text class="body" x="68" y="206">Generic Donor</text>

    <rect class="checkbox" x="20" y="226" width="16" height="16"/>
    <circle class="legend" cx="54" cy="234" r="6" fill="#d32f2f"/>
    <text class="body" x="68" y="238">Generic Acceptor</text>

    <rect class="checkbox" x="20" y="258" width="16" height="16"/>
    <circle class="legend" cx="54" cy="266" r="6" fill="#2e7d32"/>
    <text class="body" x="68" y="270">Generic Apolar</text>

    <line class="divider" x1="20" y1="292" x2="540" y2="292"/>
    <text class="subhead" x="20" y="318">Advanced (collapsed)</text>
    <text class="muted" x="20" y="338">Expand to access charged/hydroxyl/water rows and Exclusion Map.</text>

    <rect class="viewer" x="20" y="360" width="520" height="146" rx="6"/>
    <path class="protein" d="M38 486 C108 380, 172 500, 230 388 C292 332, 364 466, 510 374"/>
    <text class="muted" x="32" y="380">No Advanced maps visible by default.</text>
  </g>

  <!-- Panel B: Loading -->
  <g transform="translate(670,100)">
    <rect class="card" x="0" y="0" width="560" height="650" rx="8"/>
    <text class="subhead" x="20" y="34">B. Loading</text>
    <text class="muted" x="20" y="54">Advanced row load in progress; local row lock</text>

    <rect class="tab-active" x="20" y="70" width="92" height="26" rx="5"/>
    <text class="tab-text-active" x="43" y="87">FragMap</text>
    <rect class="tab-inactive" x="118" y="70" width="80" height="26" rx="5"/>
    <text class="tab-text" x="143" y="87">Ligand</text>

    <rect class="button-disabled" x="20" y="108" width="95" height="30" rx="5"/>
    <text class="muted" x="39" y="128">Hide all</text>
    <rect class="button-disabled" x="125" y="108" width="120" height="30" rx="5"/>
    <text class="muted" x="146" y="128">Reset defaults</text>
    <rect class="button-disabled" x="255" y="108" width="95" height="30" rx="5"/>
    <text class="muted" x="276" y="128">Reset view</text>

    <line class="divider" x1="20" y1="154" x2="540" y2="154"/>
    <text class="subhead" x="20" y="178">Advanced</text>

    <rect class="checkbox-disabled" x="20" y="194" width="16" height="16"/>
    <circle class="legend" cx="54" cy="202" r="6" fill="#f57c00"/>
    <text class="muted" x="68" y="206">Positively Charged (loading...)</text>

    <rect class="checkbox-disabled" x="20" y="226" width="16" height="16"/>
    <circle class="legend" cx="54" cy="234" r="6" fill="#9e9e9e"/>
    <text class="muted" x="68" y="238">Exclusion Map (queued)</text>
    <rect class="disabled-pill" x="308" y="222" width="84" height="20" rx="10"/>
    <text class="muted" x="332" y="236">iso disabled</text>

    <rect class="warn" x="20" y="266" width="520" height="98" rx="6"/>
    <text class="body" x="36" y="292">Loading selected Advanced map...</text>
    <text class="muted" x="36" y="314">Only the active loading row is locked; other state remains stable.</text>
    <text class="muted" x="36" y="336">Exclusion retains fixed gray wireframe contract.</text>

    <rect class="viewer" x="20" y="380" width="520" height="126" rx="6"/>
    <text class="muted" x="32" y="404">Viewer placeholder while Advanced row resolves.</text>
  </g>

  <!-- Panel C: Empty -->
  <g transform="translate(1300,100)">
    <rect class="card" x="0" y="0" width="560" height="650" rx="8"/>
    <text class="subhead" x="20" y="34">C. Empty</text>
    <text class="muted" x="20" y="54">Advanced inventory unavailable for current session</text>

    <rect class="tab-active" x="20" y="70" width="92" height="26" rx="5"/>
    <text class="tab-text-active" x="43" y="87">FragMap</text>
    <rect class="tab-inactive" x="118" y="70" width="80" height="26" rx="5"/>
    <text class="tab-text" x="143" y="87">Ligand</text>

    <rect class="button" x="20" y="108" width="95" height="30" rx="5"/>
    <text class="body" x="39" y="128">Hide all</text>
    <rect class="button" x="125" y="108" width="120" height="30" rx="5"/>
    <text class="body" x="146" y="128">Reset defaults</text>
    <rect class="button" x="255" y="108" width="95" height="30" rx="5"/>
    <text class="body" x="276" y="128">Reset view</text>

    <line class="divider" x1="20" y1="154" x2="540" y2="154"/>
    <text class="subhead" x="20" y="178">Advanced</text>

    <rect class="helper" x="20" y="194" width="520" height="126" rx="6"/>
    <text class="body" x="36" y="220">No Advanced rows available.</text>
    <text class="muted" x="36" y="242">Possible causes: filtered dataset or startup disable-intent for Advanced maps.</text>
    <text class="muted" x="36" y="264">Primary rows remain usable; Exclusion remains non-editable when available.</text>
    <text class="muted" x="36" y="286">No route reload; camera and ligand state are unchanged.</text>

    <rect class="viewer" x="20" y="336" width="520" height="170" rx="6"/>
    <path class="protein" d="M46 488 C102 388, 170 498, 230 396 C288 344, 370 458, 510 382"/>
    <text class="muted" x="32" y="356">Primary-only context shown; Advanced section is empty.</text>
  </g>

  <!-- Panel D: Error -->
  <g transform="translate(40,820)">
    <rect class="card" x="0" y="0" width="905" height="680" rx="8"/>
    <text class="subhead" x="20" y="34">D. Error</text>
    <text class="muted" x="20" y="54">Single Advanced row fails; Exclusion and other rows remain available</text>

    <rect class="tab-active" x="20" y="70" width="92" height="26" rx="5"/>
    <text class="tab-text-active" x="43" y="87">FragMap</text>
    <rect class="tab-inactive" x="118" y="70" width="80" height="26" rx="5"/>
    <text class="tab-text" x="143" y="87">Ligand</text>

    <rect class="error" x="20" y="108" width="865" height="58" rx="6"/>
    <text class="body" x="36" y="132">Failed to load Negatively Charged map. Retry this row only.</text>
    <text class="muted" x="36" y="152">Exclusion and unaffected rows remain interactive and visible state is preserved.</text>

    <rect class="viewer" x="20" y="184" width="470" height="300" rx="6"/>
    <path class="protein" d="M48 430 C108 260, 170 440, 230 280 C280 212, 330 390, 450 252"/>
    <polyline class="mesh-orange" points="120,362 162,334 218,362 186,412 126,402 120,362"/>
    <line class="mesh-orange" x1="162" y1="334" x2="186" y2="412"/>
    <line class="mesh-orange" x1="126" y1="402" x2="218" y2="362"/>
    <polyline class="mesh-gray" points="270,332 300,312 346,334 316,384 272,372 270,332"/>
    <line class="mesh-gray" x1="300" y1="312" x2="316" y2="384"/>
    <line class="mesh-gray" x1="272" y1="372" x2="346" y2="334"/>
    <text class="muted" x="32" y="206">Viewer mock: Exclusion remains visible in fixed gray wireframe.</text>

    <line class="divider" x1="510" y1="184" x2="885" y2="184"/>
    <text class="subhead" x="510" y="210">Advanced rows</text>

    <rect class="checkbox-disabled" x="510" y="226" width="16" height="16"/>
    <circle class="legend" cx="544" cy="234" r="6" fill="#c2185b"/>
    <text class="muted" x="558" y="238">Negatively Charged (error)</text>

    <rect class="checkbox-on" x="510" y="258" width="16" height="16"/>
    <text class="body" x="514" y="271">✓</text>
    <circle class="legend" cx="544" cy="266" r="6" fill="#9e9e9e"/>
    <text class="body" x="558" y="270">Exclusion Map</text>
    <rect class="disabled-pill" x="748" y="254" width="128" height="20" rx="10"/>
    <text class="muted" x="784" y="268">iso disabled</text>

    <rect class="chip" x="510" y="304" width="375" height="28" rx="14"/>
    <text class="muted" x="522" y="323">Row-level retry details stay within M5.6 reliability scope.</text>
  </g>

  <!-- Panel E: Success -->
  <g transform="translate(985,820)">
    <rect class="card" x="0" y="0" width="875" height="680" rx="8"/>
    <text class="subhead" x="20" y="34">E. Success</text>
    <text class="muted" x="20" y="54">Advanced rows active; Exclusion visible with fixed gray wireframe and disabled iso</text>

    <rect class="tab-active" x="20" y="70" width="92" height="26" rx="5"/>
    <text class="tab-text-active" x="43" y="87">FragMap</text>
    <rect class="tab-inactive" x="118" y="70" width="80" height="26" rx="5"/>
    <text class="tab-text" x="143" y="87">Ligand</text>

    <rect class="viewer" x="20" y="108" width="510" height="340" rx="6"/>
    <path class="protein" d="M42 404 C96 234, 170 438, 234 268 C296 198, 370 350, 506 224"/>

    <polyline class="mesh-magenta" points="120,338 154,316 198,340 170,390 124,378 120,338"/>
    <line class="mesh-magenta" x1="154" y1="316" x2="170" y2="390"/>
    <line class="mesh-magenta" x1="124" y1="378" x2="198" y2="340"/>

    <polyline class="mesh-orange" points="216,304 250,284 298,308 266,362 220,348 216,304"/>
    <line class="mesh-orange" x1="250" y1="284" x2="266" y2="362"/>
    <line class="mesh-orange" x1="220" y1="348" x2="298" y2="308"/>

    <polyline class="mesh-gray" points="306,346 338,326 384,350 352,404 308,392 306,346"/>
    <line class="mesh-gray" x1="338" y1="326" x2="352" y2="404"/>
    <line class="mesh-gray" x1="308" y1="392" x2="384" y2="350"/>

    <text class="muted" x="34" y="130">Gray mesh indicates Exclusion map fixed-style rendering.</text>

    <line class="divider" x1="550" y1="108" x2="855" y2="108"/>
    <text class="subhead" x="550" y="136">Advanced rows</text>

    <rect class="checkbox-on" x="550" y="156" width="16" height="16"/>
    <text class="body" x="554" y="169">✓</text>
    <circle class="legend" cx="584" cy="164" r="6" fill="#f57c00"/>
    <text class="body" x="598" y="168">Positively Charged</text>

    <rect class="checkbox-on" x="550" y="188" width="16" height="16"/>
    <text class="body" x="554" y="201">✓</text>
    <circle class="legend" cx="584" cy="196" r="6" fill="#c2185b"/>
    <text class="body" x="598" y="200">Negatively Charged</text>

    <rect class="checkbox-on" x="550" y="220" width="16" height="16"/>
    <text class="body" x="554" y="233">✓</text>
    <circle class="legend" cx="584" cy="228" r="6" fill="#9e9e9e"/>
    <text class="body" x="598" y="232">Exclusion Map</text>
    <rect class="disabled-pill" x="744" y="216" width="136" height="20" rx="10"/>
    <text class="muted" x="780" y="230">iso disabled (fixed)</text>

    <rect class="good" x="550" y="258" width="305" height="84" rx="6"/>
    <text class="body" x="566" y="284">M5.3 success contract:</text>
    <text class="muted" x="566" y="306">Advanced rows toggle in place.</text>
    <text class="muted" x="566" y="326">Exclusion remains fixed gray wireframe with no editable iso.</text>
  </g>
</svg>

# M5.2 Preview Index - Primary-3 Visibility Engine

## M5.2 Scope Lock
- `M5.2` only.
- Includes Primary-3 runtime behavior preview:
  - checkbox toggle behavior,
  - lazy first load on first toggle-on,
  - cache reuse on subsequent toggle-on,
  - camera preserved during map show/hide.
- Excludes `M5.3+` behavior (advanced/exclusion runtime semantics, iso controls, bulk actions, reliability hardening).

## Coverage Checklist
- [x] `Default` state: Primary-3 rows present and unchecked, no visible maps.
- [x] `Loading` state: first toggle-on shows row-level loading treatment (lazy first load path).
- [x] `Empty` state: maps hidden with cache-warmed helper copy after prior interactions.
- [x] `Error` state: non-blocking row-level load failure treatment for one Primary row.
- [x] `Success` state: Primary row shown as visible after cache reuse with camera-preserved note.
- [x] Right-panel framework remains aligned to approved shell (`FragMap` active, `Ligand` sibling tab).
- [x] Scope is constrained to Primary-3 engine behavior only (no M5.3+ runtime controls shown).

## Artifact Matrix
| State | Artifact | Notes |
|---|---|---|
| Default | `desktop/m5.2-primary3-visibility-states.svg` (Panel A) | All Primary rows unchecked, no maps visible |
| Loading | `desktop/m5.2-primary3-visibility-states.svg` (Panel B) | First toggle-on enters lazy-load row state |
| Empty | `desktop/m5.2-primary3-visibility-states.svg` (Panel C) | Zero visible maps, cache warmed |
| Error | `desktop/m5.2-primary3-visibility-states.svg` (Panel D) | Row-level failure treatment, non-blocking panel |
| Success | `desktop/m5.2-primary3-visibility-states.svg` (Panel E) | Cached toggle success and camera-preserved outcome |

## Resolved UI Decisions
1. Loading interaction lock (`Option B`): while one Primary row is in first-load `loading`, non-loading Primary rows are temporarily disabled until the row request resolves.
2. Success feedback style (`Option A`): show persistent inline success text (`Loaded from cache`) so runtime behavior is explicit and debuggable during M5.2 validation.
3. Retry timing (`Option B`): keep inline row retry deferred to `M5.6` reliability scope (not introduced in `M5.2`).

## Traceability
- Plan refs: `docs/plans/execution-plan.md` Sections `1.3`, `3`, and `3.1` (`M5.2`).
- Spec refs: `docs/specs/fragmap-controls-spec.md` Sections `7`, `8.1`, `9`, `11`, and `13`.

## Approval State
- Current: `APPROVED UI PREVIEW`
- Approval reference: explicit in-thread approval recorded on 2026-02-16.
